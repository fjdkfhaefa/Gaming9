<body id="body">
</body>
<style>
    aside{
        position:fixed;
        right: -50px;
        width: 250px;
    }
    #home{
        position: relative;
		right: -50px;
        width:50px;height:50px;border:solid 10px gray;border-radius:100px;margin:20px;
    }
    #home:hover{
        border-color: skyblue;
    }
    .bow{
        background-color: gray
    }
    #full0{
        width: auto;
        height: auto;
        position:relative;
        top:50px;
        right: -100px;
    }
    #full0:hover .bow{
        background-color: skyblue;
    }
    #speed{
        right: 50px;
        width:200px;
        top:100px;
        position:relative;
        display: block;
    }
    #speed2{
        right: 50px;
        width:200px;
        top:110px;
        position:relative;
        display: block;
    }
</style>
<aside>
    <a href="index.html"><div id="home"></div></a>
    <div id="full0" onclick="full0click()">
        <div class="bow"id="x0" style="width: 22.68px; height: 9.072px; position: relative; left: -27.216px; top: -27.216px;">
            <div class="bow"id="y0" style="width: 9.072px; height: 22.68px;position: relative; left: 0px; top: 3.1752px;">
            </div>
        </div>
        <div class="bow"id="x1" style="width: 22.68px; height: 9.072px;position: relative; top: -36.288px; left: 20.412px;">
            <div class="bow"id="y1" style="width: 9.072px; height: 22.68px;position: relative; top: 3.1752px; left: 13.608px;">
            </div>
        </div>
        <div class="bow"id="x2" style="width: 22.68px; height: 9.072px;position: relative; top: 18.144px; left: 20.412px;">
            <div class="bow"id="y2" style="width: 9.072px; height: 22.68px;position: relative; top: -15.876px; left: 13.608px;">
            </div>
        </div>
        <div class="bow"id="x3" style="width: 22.68px; height: 9.072px;position: relative; top: 9.072px; left: -27.216px;">
            <div class="bow"id="y3" style="width: 9.072px; height: 22.68px;position: relative; top: -15.876px; left: 0px;">
            </div>
        </div>
    </div>
    <input type="range" id="speed" name="speed"
    min="0.1" max="30">
    <input type="range" id="speed2" name="speed2"
    min="0.01" max="20">
</aside>
<script>
    var speed = 1
    spmeter = document.getElementById("speed")
	spmeter2 = document.getElementById("speed2")
	spmeter.addEventListener("input", (event) => {
		cRate = Number(event.target.value)
	})
	spmeter2.addEventListener("input", (event) => {
		speed = Number(event.target.value)
	})
    function full0click(){
        if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
        } else if (document.exitFullscreen) {
        document.exitFullscreen();
        }
        // サイズを取得

    }
//txt0は2DシューティングのBIGINNINGのコードだけどここではタイピング風アニメーション作るための
//見かけのコードでただの文字列
var txt0 = `
alert("WASD移動 J撃つ K高速 L低速")
//変数で使ってる略 s → サイズ w → 横幅 h → 高さ e → CPU(enemy) x → x座標 y → y座標 c → canvas b → 弾(bullet) たまにかぶってるのもあるごめん
var canvas = document.getElementById("test")//id 'can'で HTML と canvas を 紐づけ
var context = canvas.getContext("2d")//そのままでok
var iw = window.innerWidth
var ih = window.innerHeight
var cw = iw
var ch = ih

canvas.width = iw//canvasサイズの指定 x
canvas.height = ih//canvasサイズの指定 y

var py = 0//プレーヤーの y 座標
var px = 0//プレーヤーの x 座標
var ps = cw*0.05//プレーヤーサイズ x
var pHP = 50//プレーヤーのHP
var score = 0//得点

var ey = ch*0.1//CPU0x座標
var ex = cw*0.5//CPU0y座標
var es = cw*0.05//CPU0サイズ
var eHP = 50//CPU0のHP

var ey2 = ch*0.1
var ex2 = cw*0.5
var es2 = cw*0.05
var eHP2 = 75

var ey3 = ch*0.2
var ex3 = cw*0.2
var ex3b = cw*0.8
var es3 = cw*0.04
var es3b = cw*0.04
var eHP3 = 40
var eHP3b = 40

var ey4 = ch*0.07
var ex4 = cw*0.5
var es4 = cw*0.06
var eHP4 = 100

var bs = cw*0.02//弾幕サイズ

var speed0 = 0//自機弾幕速度
var speed01 = cw*0.008//プレーヤーの速度
var eSpeed0 = 0//CPU0弾幕スピード
var eSpeed2 = 0//CPU2弾幕スピード
var eSpeed3 = 0
var eSpeed3b = 0
var eSpeed4 = 0
var eSpeed4b = 0

var ts = cw * 0.02//テキストサイズ
var tx = cw * 0.01//テキスト1 位置 x
var ty = ch * 0.05//テキスト1 位置 y

var tx2 = cw * 0.9//テキスト2 位置 x

var tSec = 0//タイム 秒
var tMin = 0//タイム 分
var tSec2 = 0//クリアタイムを最初から秒でも測っておいたらスコアの計算が楽

var tSpace = cw*0.12//まとまったテキスト同志の間隔

var LR = "left"//CPU0の進行方向
var LR2 = "left"//CPU1の進行方向
var LR3 = "right"
var LR3b = "right"
var LR4 = "left"

var r = 0//乱数0
var r2 = 0
var r3 = 0
var r3a = Math.random()//eShot3() の呼び出しタイミング
var r3b = Math.random()//eShot3b() の呼び出しタイミング
var r4 = 0

var r4c = 0//eShot4b()を呼び出すタイミング制御に使う
var r4c2 = 0

var r41 = 0//eShot4b() で撃つ弾幕のタイミング制御に使う

var rcolor = "yellow"

var rmin = 1//CPU0の弾幕発射タイミング早いとき
var rmax = 4//CPU0の弾幕発射タイミング遅いとき
var rmin2 = 1//CPU3,3bの弾幕発射タイミング
var rmax2 = 2

var rmin = 2
var rmax = 3

var rmin4 = 1//eShot4b()の呼び出しタイミング 最小値
var rmax4 = 2 //eShot4b()の呼び出しタイミング 最大値

var fire = true//CPU0 に弾を撃たせる
var fire2 = true//CPU2 に弾を撃たせる
var fire3 = true
var fire3b = true
var fire4 = false

//初期状態では押されてないので false
//操作キー
var W = false//前進
var A = false//左
var S = false//後退
var D = false//右
var J = false//撃つ
var K = false//高速移動
var L = false//低速移動
var B = false//ボム
var Enter = false

//残骸↓
var fix = 0//バグ修正用
var test = 0//テスト用気にしないで
var test2 = 0

var slow0 = 0//CPU3の弾幕の内斜めに進む弾幕に対して減速させる
var slow1 = 0//CPU3b..
var slow4 = 0//CPU4
var slow41 = 0
var slow44 = 0
var slow47 = 0
var slow410 = 0
var slow413 = 0

var skiw4b = 0

var finished3 = true
var finished3b = true

var finished4 = true//eShot4の処理が終了したかどうか
var finished4b = true
var finished4b2 = true

var pPower = 1

var count0 = 0
var count4 = 0
var count4b = 0
var count41 = 0

var Lock = false
var Lock2 = true
var Lock3 = true
var Lock3b = true
var Lock4 = true

var LockeShot3b = false
var LockeShot3 = false

var reverse3b = false
var reverse3 = false

var LockCoin = false

window.onresize = function(){//画面サイズが変更されたときの値の更新
    iw = window.innerWidth
    ih = window.innerHeight
    canvas.width = iw
    canvas.height = ih
    cw = iw
    ch = ih
    py = 0//プレーヤーの y 座標
    px = 0//プレーヤーの x 座標
    ps = cw*0.05//プレーヤーサイズ x
    pHP = 50//プレーヤーのHP
    score = 0//得点

    ey = ch*0.1//CPU0x座標
    ex = cw*0.5//CPU0y座標
    es = cw*0.05//CPU0サイズ
    eHP = 50//CPU0のHP

    ey2 = ch*0.1
    ex2 = cw*0.5
    es2 = cw*0.05
    eHP2 = 75

    ey3 = ch*0.2
    ex3 = cw*0.2
    ex3b = cw*0.8
    es3 = cw*0.04
    es3b = cw*0.04
    eHP3 = 40
    eHP3b = 40

    ey4 = ch*0.07
    ex4 = cw*0.5
    es4 = cw*0.06
    eHP4 = 100

    bs = cw*0.02//弾幕サイズ

    speed0 = 0//自機弾幕速度
    speed01 = cw*0.008//プレーヤーの速度
    eSpeed0 = 0//CPU0弾幕スピード
    eSpeed2 = 0//CPU2弾幕スピード
    eSpeed3 = 0
    eSpeed3b = 0
    eSpeed4 = 0
    eSpeed4b = 0

    ts = cw * 0.02//テキストサイズ
    tx = cw * 0.01//テキスト1 位置 x
    ty = ch * 0.05//テキスト1 位置 y

    tx2 = cw * 0.9//テキスト2 位置 x
    
}

//キーが押されたことを検知する
document.addEventListener("keydown", function(event0){
    if(event0.key === "w")
    {
        W = true
    }
    if(event0.key === "a")
    {
        A = true
    }
    if(event0.key === "s")
    {
        S = true
    }
    if(event0.key === "d")
    {
        D = true
    }
    if(event0.key === "j")
    {
        shot0()
    }
    if(event0.key === "k")
    {
        K = true
        //kで高速移動
        speed01 = cw*0.015
    }
    if(event0.key === "l")
    {

        L = true
        //lで低速移動
        speed01 = cw*0.002
    }

})
clear()
LorR()
Timer()
roop2()
function clear(){
    context.fillStyle = "black"
    context.fillRect(0,0,cw,ch)//画面全体をクリア

    if(eHP4 <= 0){

            context.font = ts*5+"px bold serif"//文字サイズの変数指定
            context.fillStyle = "white"
            context.fillText("CLEAR!! :D",ts,ch*0.5-ts)
        }
    //画面をクリアし続けないと図形の軌跡が残ってしまう
    if(pHP >= 0){
        requestAnimationFrame(clear)//requestAnimationFrame()は重複しない限り複数回使える
    }
}

// キー が離されたことを検知する
document.addEventListener("keyup", function(event0){
    if(event0.key === "w")
    {
        W = false//falseにして true の時のみ実行される処理を止める この場合は 115行目の if(w == true){} の処理を止める
    }
    if(event0.key === "a")
    {
        A = false
    }
    if(event0.key === "s")
    {
        S = false
    }
    if(event0.key === "d")
    {
        D = false
    }
    if(event0.key === "j")
    {
        J = false
    }
    if(event0.key === "k")
    {
        K = false
        //kを離したら通常スピードに戻す
        speed01 = cw*0.008
    }
    if(event0.key === "l")
    {
        L = false
        //lを離したら通常スピードに戻す
        speed01 = cw*0.008
    }
    if(event0.key === "Enter")
    {
        Enter = false
    }
})

function LorR() {//CPU0 を左右どっちに進ませるか
    if(Lock == false){
        function roop6()
        {
            r = Math.random()//乱数を生成する
            if(r > 0.5){
                LR = "right"
            }else{
                LR = "left"
            }

            setTimeout(roop6,3000)
        }
        roop6()
    }


    function roop12() 
    {
        if(px > ex2){//プレーヤーが CPU2 より右にいたら
            LR2 = "right"//右に移動する
        }else{//プレーヤーが CPU2 より左にいたら
            LR2 = "left"//左に移動する
        }
        if(Lock2 == false){//CPU2が生きていたら
            setTimeout(roop12,1000)
        }
    }
    roop12()
}

function Timer() {//スタートからどのくらいの時間が経過したか数える
    function roop8(){
        if(tSec < 60){
            tSec = tSec + 1//60秒未満なら秒数を 1 増やす
            tSec2 = tSec2 + 1//クリアタイムを最初から秒でも測っておいたらスコアの計算が楽
        }else{
            tSec = 0//60秒になったら s 秒 をリセット
            tMin = tMin + 1//60秒になったら m 分 を 1 増やす
        }

        if(Lock == false){
            //↓CPU0 の弾幕発射タイミングを制御
            if(r2 == 0){//r2の値を減らしていって 0 になったらもう一度 r2 を ランダムに生成する この時に CPU0 の弾幕を撃つ
                fire = true
                r2 = Math.floor(Math.random() * (rmax + 1 - rmin)) + rmin//最大最小を指定して乱数を生成
            }else{
                fire = false
            r2 = r2 - 1//0 になるまで値を減らし続ける
            }

            if(fire == true && Lock == false){//CPU0がまだ生きてたら撃つ
                eShot0()
            }
        }


        if(Lock2 == false){
            //↓CPU2 の弾幕発射タイミングを制御
            if(r3 == 0){//r3の値を減らしていって 0 になったらもう一度 r3 を ランダムに生成する この時に CPU2 の弾幕を撃つ
                fire2 = true
                r3 = Math.floor(Math.random() * (rmax2 + 1 - rmin2)) + rmin2//最大最小を指定して乱数を生成

            }else{
                fire2 = false
            r3 = r3 - 1//0 になるまで値を減らし続ける
            }
            if(fire2 == true && Lock2 == false){//CPU2がまだ生きてたら撃つ
                eShot2()
            }

        }
        rcolor= "rgb(" + (~~(256 * Math.random())) + ", " + (~~(256 * Math.random())) + ", " + (~~(256 * Math.random())) + ")"
        setTimeout(roop8,1000)

    }
    roop8()
}

function timingA(){//CPU3の撃つタイミングの制御
    if(Lock3 == false){
        if(finished3 == true){
        r3a = Math.random()
        eShot3()
        }
        setTimeout(timingA,r3a*1000)
    }
}

function timingB(){//CPU3の撃つタイミングの制御
    if(Lock3b == false){
        if(finished3b == true){
        r3b = Math.random()
        eShot3b()
        }
        setTimeout(timingB,r3b*1000)
    }
}


function timing4(){
    if(finished4 == true && count4 == 0){
        eShot4()
    }

    setTimeout(timing4,100)
}

function timing4b(){
    if(Lock4 == false){
        r4c = Math.random()//1以下の乱数の生成
        if(finished4 == true && finished4b == true){//eShot4()が一回終わったら count4 = 1 になる
            eShot4b()
        }

    }
    setTimeout(timing4b,1000*r4c)//1000ms*1以下の乱数 ms後に呼び出す
}

function timing4b2(){
    if(Lock4 == false){
        r4c2 = Math.random()//1以下の乱数の生成
        if(finished4 == true && finished4b2 == true){//eShot4()が一回終わったら count4 = 1 になる
            eShot4b2()
        }

    }
    setTimeout(timing4b2,500*r4c2)//1000ms*1以下の乱数 ms後に呼び出す
}


function LorR4() {
    function roop16(){
        if(A == true){//プレーヤーが左
            LR4 = "right"//CPU4 は逆向きの右ww
        }else{
            LR4 = "left"
        }
        setTimeout(roop16,1000) 
    }
    roop16()

}

function shot0() {//自機弾幕用の関数 j が押されたら動作する
    let speed1 = speed0//ローカル変数 let にして処理の実行中にリセットされるのを防ぎたい!!
    let bx2 = px//ローカル変数にすることで自機弾幕が自機に追従しなくなる!!
    let by2 = py//これ思いつくのにめっちゃ苦労した（；´д｀）ゞ
    function roop0(){
        context.fillStyle = "skyblue"
        speed1 = speed1 + cw*0.02//自機弾幕速度
        context.fillRect(bx2,by2-speed1,bs,bs)


        //CPU0に対する自機弾幕の当たり判定↓
        if(Lock == false){//CPU0が生きてるなら
            if(by2-speed1 <= ey+es && bx2+bs >= ex)//自機弾幕 y 座標 <= CPU0 y座標 + CPU0サイズ && 自機弾幕 x 座標 + 弾幕サイズ >= CPU0 x座標
            {
                if(by2-speed1+bs >= ey && bx2 <= ex+es)//自機弾幕 y 座標 + 弾幕サイズ >= CPU0 y座標 && 自機弾幕 x 座標 <= CPU0 x 座標 + CPU0サイズ
                {
                    if(eHP <= 0){
                        es = 0//CPU0 の HP が 0 になったら* CPU0 サイズ を 0 にして見えなくする
                        if(es == 0){
                            Lock = true
                            Lock2 = false
                        }
                        LorR()//次に呼び出す CPU2 のためにもう一度 LorR() を呼び出す。169行目

                    }else{
                        eHP = eHP - pPower//CPU0 に自機弾幕が当たったら CPU0 にダメージを与える
                        score = score + 1//CPU0 にダメージを与えたらスコアを増やす
                    }
                }
            }
        }


        //CPU2に対する自機弾幕の当たり判定↓
        if(Lock2 == false){
            if(by2-speed1 <= ey2+es2 && bx2+bs >= ex2)//自機弾幕 y 座標 <= CPU2 y座標 + CPU2サイズ && 自機弾幕 x 座標 + 弾幕サイズ >= CPU2 x座標
            {
                if(by2-speed1+bs >= ey2 && bx2 <= ex2+es2)//自機弾幕 y 座標 + 弾幕サイズ >= CPU2 y座標 && 自機弾幕 x 座標 <= CPU2 x 座標 + CPU2サイズ
                {
                    if(eHP2 <= 0){
                        es2 = 0//CPU2 の HP が 0 になったら* CPU2 サイズ を 0 にして見えなくする
                        LorR4()//次に呼び出す CPU? のためにもう一度 LorR() を呼び出す。169行目
                        Lock3 = false
                        Lock3b = false
                        timingA()
                        timingB()
                        Lock2 = true
                    }else{
                        eHP2 = eHP2 - pPower//CPU2 に自機弾幕が当たったら CPU2 にダメージを与える
                        score = score + 1//CPU2 にダメージを与えたらスコアを増やす
                    }
                }
            }
        }

        if(Lock3 == false){
            //CPU3に対する自機弾幕の当たり判定↓
            if(by2-speed1 <= ey3+es3 && bx2+bs >= ex3)//自機弾幕 y 座標 <= CPU3 y座標 + CPU3サイズ && 自機弾幕 x 座標 + 弾幕サイズ >= CPU3 x座標
            {
                if(by2-speed1+bs >= ey3 && bx2 <= ex3+es3)//自機弾幕 y 座標 + 弾幕サイズ >= CPU3 y座標 && 自機弾幕 x 座標 <= CPU3 x 座標 + CPU3サイズ
                {
                    if(eHP3 <= 0){
                        es3 = 0//CPU3 の HP が 0 になったら* CPU3 サイズ を 0 にして見えなくする
                        if(Lock3b == true){
                            timing4()
                            timing4b()
                            timing4b2()
                            Lock4 = false
                        }
                        Lock3 = true
                    }else{
                        eHP3 = eHP3 - pPower//CPU3 に自機弾幕が当たったら CPU3 にダメージを与える
                        score = score + 1//CPU3 にダメージを与えたらスコアを増やす
                    }
                }
            }
        }
        if(Lock3b == false){
            //CPU3bに対する自機弾幕の当たり判定↓
            if(by2-speed1 <= ey3+es3b && bx2+bs >= ex3b)//自機弾幕 y 座標 <= CPU3b y座標 + CPU3bサイズ && 自機弾幕 x 座標 + 弾幕サイズ >= CPU3b x座標
            {
                if(by2-speed1+bs >= ey3 && bx2 <= ex3b+es3b)//自機弾幕 y 座標 + 弾幕サイズ >= CPU3 y座標 && 自機弾幕 x 座標 <= CPU3 x 座標 + CPU3サイズ
                {
                    if(eHP3b <= 0){
                        es3b = 0//CPU3 の HP が 0 になったら* CPU3 サイズ を 0 にして見えなくする
                        if(Lock3 == true){
                            timing4()
                            timing4b()
                            timing4b2()
                            Lock4 = false
                        }
                        Lock3b = true
                    }else{
                        eHP3b = eHP3b - pPower//CPU3 に自機弾幕が当たったら CPU3 にダメージを与える
                        score = score + 1//CPU3 にダメージを与えたらスコアを増やす
                    }
                }
            }
        }

        if(Lock4 == false){
            if(by2-speed1 < ey4+es4 && by2-speed1+bs > ey4){
                if(bx2+bs > ex4 && bx2 < ex4+es4){
                    eHP4 -= pPower
                    score = score+1
                }
                if(eHP4 <= 0){
                    if(fix == 0){
                        scoreOutput()
                        fix=1//二回目を呼び出さない
                        alert("おめでとう👍クリアしました")
                    }
                    Lock4 = true
                }
            }
        }

        if(by2-speed1 > 0){
        requestAnimationFrame(roop0)//stAnimationFrame() はブラウザの更新毎に処理をするために使う
        //これはとても滑らかに動く アニメーションを作るなら setTimeout() とかよりもこっちが良いと思う。
        }
    }
    roop0()
}

function eShot0() {//CPU0 の弾幕
    //一応 let 使った
    ebx = ex//CPU0弾幕座標 x 初回のみロード
    let eby = ey+es //CPU0 y 座標 + CPU0サイズ = CPU0弾幕座標 y 初回のみロード
    eSpeed0 = 0
    function bulletAnimation(){
        if(eby+eSpeed0 <= ch && Lock == false){//弾が画面を飛び出してなかったら
            eSpeed0 = eSpeed0 + cw*0.006//弾幕のスピード
            context.fillStyle = "orange"
            context.fillRect(ebx,eby+eSpeed0,bs,bs)//一つめの弾幕描画
            if(eSpeed0 > ch*0.2){//一つ目の弾幕が ch*0.2 のy座標 を通り過ぎたら二つ目を発射
                context.fillRect(ebx,eby+eSpeed0-ch*0.2,bs,bs)
            }

            //↓プレーヤーに対するCPU0の弾幕当たり判定
            if(eby+eSpeed0+bs >= py && eby+eSpeed0 <= py+ps){//CPU0弾幕 y 座標 + 弾幕サイズ >= プレーヤー y 座標 && CPU0弾幕 y 座標 <= プレーヤー y 座標 + プレーヤーサイズ
                if(ebx+bs >= px && ebx <= px+ps){//CPU0弾幕 x 座標 + 弾幕サイズ >= プレーヤー x 座標 && CPU弾幕 x 座標 <= プレーヤー x 座標 + プレーヤーサイズ
                    pHP = pHP - 1

                }
            }
            //↓プレーヤーに対するCPU0の弾幕当たり判定
            if(eby+eSpeed0+bs-ch*0.2 >= py && eby+eSpeed0-ch*0.2 <= py+ps){//CPU0弾幕 y 座標 + 弾幕サイズ - 遅延 >= プレーヤー y 座標 && CPU0弾幕 y 座標 -遅延 <= プレーヤー y 座標 + プレーヤーサイズ
                if(ebx+bs >= px && ebx <= px+ps){//CPU0弾幕 x 座標 + 弾幕サイズ >= プレーヤー x 座標 && CPU弾幕 x 座標 <= プレーヤー x 座標 + プレーヤーサイズ
                    pHP = pHP - 1

                }
            }
            if(pHP >= 0){//プレーヤーが生きている限り処理を続ける
                requestAnimationFrame(bulletAnimation)
            }



        }else{
            eSpeed0 = eSpeed0
        }
    }

    bulletAnimation()//初回ロード
}

function eShot2() {//CPU2 の弾幕
    ebx2 = ex2//CPU2弾幕座標 x 初回のみロード
    let eby2 = ey2+es2//CPU2 y 座標 + CPU2サイズ = CPU2弾幕座標 y 初回のみロード
    eSpeed2 = 0
    function bulletAnimation2(){
        if(eby2+eSpeed2-ch*0.4 <= ch && eHP2 >= 0){//弾が画面を飛び出してなかったら
            eSpeed2 = eSpeed2 + cw*0.01//弾幕のスピード
            context.fillStyle = "red"
            context.fillRect(ebx2,eby2+eSpeed2,bs,bs)//一つめの弾幕描画
            if(eSpeed2 > ch*0.2){//一つ目の弾幕が ch*0.2 のy座標 を通り過ぎたら二つ目を発射
                context.fillRect(ebx2,eby2+eSpeed2-ch*0.2,bs,bs)
                context.fillRect(ebx2-eSpeed2*0.5,eby2+eSpeed2-ch*0.2,bs,bs)//左斜め弾幕
                context.fillRect(ebx2+eSpeed2*0.5,eby2+eSpeed2-ch*0.2,bs,bs)//右斜め弾幕
            }
            if(eSpeed2 > ch*0.4){
                context.fillRect(ebx2,eby2+eSpeed2-ch*0.4,bs,bs)
            }

            //↓プレーヤーに対するCPU2の弾幕当たり判定
            if(eby2+eSpeed2+bs >= py && eby2+eSpeed2 <= py+ps){//CPU2弾幕 y 座標 + 弾幕サイズ >= プレーヤー y 座標 && CPU2弾幕 y 座標 <= プレーヤー y 座標 + プレーヤーサイズ
                if(ebx2+bs >= px && ebx2 <= px+ps){//CPU2弾幕 x 座標 + 弾幕サイズ >= プレーヤー x 座標 && CPU弾幕 x 座標 <= プレーヤー x 座標 + プレーヤーサイズ
                    pHP = pHP - 2

                }
            }
            //↓プレーヤーに対するCPU2の弾幕当たり判定
            if(eby2+eSpeed2+bs-ch*0.2 >= py && eby2+eSpeed2-ch*0.2 <= py+ps){//CPU2弾幕 y 座標 + 弾幕サイズ - 遅延 >= プレーヤー y 座標 && CPU2弾幕 y 座標 -遅延 <= プレーヤー y 座標 + プレーヤーサイズ
                if(ebx2+bs >= px && ebx2 <= px+ps){//CPU2弾幕 x 座標 + 弾幕サイズ >= プレーヤー x 座標 && CPU弾幕 x 座標 <= プレーヤー x 座標 + プレーヤーサイズ
                    pHP = pHP - 2

                }
            }
            if(eby2+eSpeed2+bs-ch*0.4 >= py && eby2+eSpeed2-ch*0.2 <= py+ps){//CPU2弾幕 y 座標 + 弾幕サイズ - 遅延 >= プレーヤー y 座標 && CPU2弾幕 y 座標 -遅延 <= プレーヤー y 座標 + プレーヤーサイズ
                if(ebx2+bs >= px && ebx2 <= px+ps){//CPU2弾幕 x 座標 + 弾幕サイズ >= プレーヤー x 座標 && CPU弾幕 x 座標 <= プレーヤー x 座標 + プレーヤーサイズ
                    pHP = pHP - 2

                }
            }
            if(eby2+eSpeed2+bs-ch*0.2 >= py && eby2+eSpeed2-ch*0.2 <= py+ps){//CPU2弾幕 y 座標 + 弾幕サイズ - 遅延 >= プレーヤー y 座標 && CPU2弾幕 y 座標 -遅延 <= プレーヤー y 座標 + プレーヤーサイズ
                if(ebx2+bs-eSpeed2*0.5 >= px && ebx2-eSpeed2*0.5 <= px+ps){//CPU2弾幕 x 座標 + 弾幕サイズ >= プレーヤー x 座標 && CPU弾幕 x 座標 <= プレーヤー x 座標 + プレーヤーサイズ
                    pHP = pHP - 2

                }
            }
            if(eby2+eSpeed2+bs-ch*0.2 >= py && eby2+eSpeed2-ch*0.2 <= py+ps){//CPU2弾幕 y 座標 + 弾幕サイズ - 遅延 >= プレーヤー y 座標 && CPU2弾幕 y 座標 -遅延 <= プレーヤー y 座標 + プレーヤーサイズ
                if(ebx2+bs+eSpeed2*0.5 >= px && ebx2+eSpeed2*0.5 <= px+ps){//CPU2弾幕 x 座標 + 弾幕サイズ >= プレーヤー x 座標 && CPU弾幕 x 座標 <= プレーヤー x 座標 + プレーヤーサイズ
                    pHP = pHP - 2

                }
            }
            if(pHP >= 0 && Lock2 == false){//プレーヤーが生きている限り処理を続ける
                requestAnimationFrame(bulletAnimation2)
            }
        }else{
            eSpeed2 = eSpeed2
        }
    }

    bulletAnimation2()//初回ロード
}

function eShot3(){ 
    eby3Locked = ey3+es3//固定値
    eby3 = ey3+es3//eby3 EnemyBullet Y 3 es3 EnemySize 3
    ebx3 = ex3
    slow0 = 0
    reverse3 = false
    LockeShot3 = false
    function bulletAnimation3(){
        if(Lock3 == false && LockeShot3 == false){
            if(eby3-ch*0.5+ey3 > ch){//弾が画面外
                reverse3 = true
            }

            if(reverse3 == true){
                if(eby3 < 0){
                    reverse3 = false
                    LockeShot3 = true//bulletAnimation3bのループを止める
                }
            }

            if(reverse3 == false){
                eby3 += cw*0.004
                slow0 -= cw*0.002
            }else{
                eby3 -= cw*0.004//弾の進行方向を逆にする
                slow0 += cw*0.002
            }
            context.fillStyle = "deepskyblue"
            context.fillRect(ebx3,eby3,bs,bs)//下
            context.fillRect(ebx3-eby3+eby3Locked-slow0,eby3+slow0,bs,bs)//左下
            context.fillRect(ebx3-eby3+eby3Locked,eby3Locked,bs,bs)//左
            context.fillRect(ebx3+eby3-eby3Locked+slow0,eby3+slow0,bs,bs)//右下
            context.fillRect(ebx3+eby3-eby3Locked,eby3Locked,bs,bs)//右
            context.fillRect(ebx3,2*eby3Locked-eby3,bs,bs)//意味わからんけど *2 せなバグる..上
            context.fillRect(ebx3-eby3+eby3Locked-slow0,2*eby3Locked-eby3-slow0,bs,bs)//意味わからんけど *2 せなバグる..左上
            context.fillRect(ebx3+eby3-eby3Locked+slow0,2*eby3Locked-eby3-slow0,bs,bs)//右上

            if(eby3+bs > py && eby3 < py+ps)//下
            {
                if(ebx3+bs > px && ebx3 < px+ps)
                {
                    pHP-=1
                }
            }
            if(eby3+bs+slow0 > py && eby3+slow0 < py+ps)//左下
            {
                if(ebx3+bs-eby3+eby3Locked-slow0 > px && ebx3-eby3+eby3Locked-slow0 < px+ps)
                {
                    pHP-=1
                }
            }
            if(eby3Locked+bs > py && eby3Locked < py+ps)//左
            {
                if(ebx3+bs-eby3+eby3Locked > px && ebx3-eby3+eby3Locked < px+ps)
                {
                    pHP-=1
                }
            }
            if(eby3+bs+slow0 > py && eby3+slow0 < py+ps)//右下
            {
                if(ebx3+bs+eby3-eby3Locked+slow0 > px && ebx3+eby3-eby3Locked+slow0 < px+ps)
                {
                    pHP-=1
                }
            }
            if(eby3Locked+bs > py && eby3Locked < py+ps)//右
            {
                if(ebx3+bs+eby3-eby3Locked > px && ebx3+eby3-eby3Locked < px+ps)
                {
                    pHP-=1
                }
            }
            if(2*eby3Locked-eby3+bs > py && 2*eby3Locked-eby3 < py+ps)//上
            {
                if(ebx3+bs > px && ebx3 < px+ps)
                {
                    pHP-=1
                }
            }
            if(2*eby3Locked-eby3-slow0+bs > py && 2*eby3Locked-eby3-slow0 < py+ps)//左上
            {
                if(ebx3+bs-eby3+eby3Locked-slow0 > px && ebx3-eby3+eby3Locked-slow0 < px+ps)
                {
                    pHP-=1
                }
            }
            if(2*eby3Locked-eby3-slow0+bs > py && 2*eby3Locked-eby3-slow0 < py+ps)//下
            {
                if(ebx3+bs+eby3-eby3Locked+slow0 > px && ebx3+eby3-eby3Locked+slow0 < px+ps)
                {
                    pHP-=1
                }
            }

            finished3 = false
            requestAnimationFrame(bulletAnimation3)//requestAnimationFrame() はアニメーションさせる関数の中で良い！関数の外に書く必要はない

        }else{
            eby3=0
            slow0 = 0
            finished3 = true
        }

    }
    bulletAnimation3()
}
function eShot3b(){
    eby3b = ey3+es3b
    ebx3b = ex3b
    eby3bLocked = ey3+es3b//固定値
    slow1 = 0
    reverse3b = false
    LockeShot3b = false
    function bulletAnimation3b(){
        if(Lock3b == false && LockeShot3b == false){
            if(eby3b-ch*0.5+ey3 > ch){//弾が画面外
                reverse3b = true
            }

            if(reverse3b == true){
                if(eby3b < 0){
                    reverse3b = false
                    LockeShot3b = true//bulletAnimation3bのループを止める
                }
            }

            if(reverse3b == false){
                eby3b += cw*0.004
                slow1 -= cw*0.002
            }else{
                eby3b -= cw*0.004//弾の進行方向を逆にする
                slow1 += cw*0.002
            }

            context.fillStyle = "deepskyblue"
            context.fillRect(ebx3b,eby3b,bs,bs)

            if(eby3b+bs > py && eby3b < py+ps){
                if(ebx3b+bs > px && ebx3b < px+ps){
                    pHP-=1
                }
            }

            context.fillRect(ebx3b-eby3b+eby3bLocked-slow1,eby3b+slow1,bs,bs)

            if(eby3b+slow1+bs > py && eby3b+slow1 < py+ps){
                if(ebx3b-eby3b+eby3bLocked-slow1+bs > px && ebx3b-eby3b+eby3bLocked-slow1 < px+ps){
                    pHP-=1
                }
            }

            context.fillRect(ebx3b-eby3b+eby3bLocked,eby3bLocked,bs,bs)

            if(eby3bLocked+bs > py && eby3bLocked < py+ps){
                if(ebx3b-eby3b+eby3bLocked+bs > px && ebx3b-eby3b+eby3bLocked < px+ps){
                    pHP-=1
                }
            }

            context.fillRect(ebx3b+eby3b-eby3bLocked+slow1,eby3b+slow1,bs,bs)

            if(eby3b+slow1+bs > py && eby3b+slow1 < py+ps){
                if(ebx3b+eby3b-eby3bLocked+slow1+bs > px && ebx3b+eby3b-eby3bLocked+slow1 < px+ps){
                    pHP-=1
                }
            }

            context.fillRect(ebx3b+eby3b-eby3bLocked,eby3bLocked,bs,bs)

            if(eby3Locked+bs > py && eby3bLocked < py+ps){
                if(ebx3b+eby3b-eby3bLocked+bs > px && ebx3b+eby3b-eby3bLocked < px+ps){
                    pHP-=1
                }
            }

            context.fillRect(ebx3b,2*eby3bLocked-eby3b,bs,bs)//意味わからんけど *2 せなバグる..

            if(2*eby3bLocked-eby3b+bs > py && 2*eby3bLocked-eby3b < py+ps){
                if(ebx3b+bs > px && ebx3b < px+ps){
                    pHP-=1
                }
            }

            context.fillRect(ebx3b-eby3b+eby3bLocked-slow1,2*eby3bLocked-eby3b-slow1,bs,bs)//意味わからんけど *2 せなバグる..

            if(2*eby3bLocked-eby3b-slow1+bs > py && 2*eby3bLocked-eby3b-slow1 < py+ps){
                if(ebx3b-eby3b+eby3Locked-slow1+bs > px && ebx3b-eby3b+eby3Locked-slow1 < px+ps){
                    pHP-=1
                }
            }

            context.fillRect(ebx3b+eby3b-eby3bLocked+slow1,2*eby3bLocked-eby3b-slow1,bs,bs)

            if(2*eby3bLocked-eby3b-slow1+bs > py && 2*eby3bLocked-eby3b-slow1 < py+ps){
                if(ebx3b+eby3b-eby3bLocked+slow1+bs > px && ebx3b+eby3b-eby3bLocked+slow1 < px+ps){
                    pHP-=1
                }
            }

            finished3b = false
            requestAnimationFrame(bulletAnimation3b)//requestAnimationFrame() はアニメーションさせる関数の中で良い！関数の外に書く必要はない

        }else{
            finished3b = true
            eby3b=0
            slow1 = 0
        }

    }
    bulletAnimation3b()
}

function eShot4(){
    ebx4 = ex4
    eby4 = ey4
    eSpeed4 = 0
    slow4 = 0
    slow41 = 0
    slow44 = 0
    slow47 = 0
    slow410 = 0
    slow413 = 0
    r401 = Math.floor( Math.random() * 3 ) + 1;//最大3最小1を指定して乱数を生成
    count401 = 1

    function bulletAnimation4() {
        if(eby4+eSpeed4 < ch){//クラスター花火
            eSpeed4 += cw*0.001
            finished4 = false
            context.fillStyle = rcolor
            context.fillRect(ebx4,eby4+eSpeed4,bs,bs)//下

            if(eby4+eSpeed4+bs > py && eby4+eSpeed4 < py+ps){
                if(ebx4+bs > px && ebx4 < px+ps){
                    pHP-=1
                }
            }
            if(r401 <= 0){
                slow4 += cw*0.001
                count401 -= 0.016
                context.fillRect(ebx4,eby4+eSpeed4-slow4*2,bs,bs)//上 eSpeed4-slow4*2 = -eSpeed4

                if(eby4+eSpeed4-slow4*2+bs > py && eby4+eSpeed4-slow4*2 < py+ps){
                    if(ebx4+bs > px && ebx4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4+slow4,eby4+eSpeed4-slow4,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                if(eby4+eSpeed4-slow4+bs > py && eby4+eSpeed4-slow4 < py+ps){
                    if(ebx4+slow4+bs > px && ebx4+slow4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4+slow4/2,eby4+eSpeed4-slow4/2*3,bs,bs)//右上 eSpeed4-slow/2*3 = -eSpeed4/2

                if(eby4+eSpeed4-slow4/2*3+bs > py && eby4+eSpeed4-slow4/2*3 < py+ps){
                    if(ebx4+slow4/2+bs > px && ebx4+slow4/2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4+slow4/2,eby4+eSpeed4-slow4/2,bs,bs)//右下

                if(eby4+eSpeed4-slow4/2+bs > py && eby4+eSpeed4-slow4/2 < py+ps){
                    if(ebx4+slow4/2+bs > px && ebx4+slow4/2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4-slow4,eby4+eSpeed4-slow4,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                if(eby4+eSpeed4-slow4+bs > py && eby4+eSpeed4-slow4 < py+ps){
                    if(ebx4-slow4+bs > px && ebx4-slow4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4-slow4/2,eby4+eSpeed4-slow4/2*3,bs,bs)//左上

                if(eby4+eSpeed4-slow4/2*3+bs > py && eby4+eSpeed4-slow4/2*3 < py+ps){
                    if(ebx4-slow4/2+bs > px && ebx4-slow4/2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4-slow4/2,eby4+eSpeed4-slow4/2,bs,bs)//左下

                if(eby4+eSpeed4-slow4/2+bs > py && eby4+eSpeed4-slow4/2 < py+ps){
                    if(ebx4-slow4/2+bs > px && ebx4-slow4/2 < px+ps){
                        pHP-=1
                    }
                }

                if(count401 <= 0){
                    slow41+=cw*0.001
                    //上----------
                            context.fillStyle = "darkviolet"
                        //上なし
                        //下
                            context.fillRect(ebx4,eby4+eSpeed4-slow4*2+slow41*2,bs,bs) //-slow4*2 + slow41*2 = +eSpeed4 下

                            if(eby4+bs+eSpeed4-slow4*2+slow41*2 > py && eby4+eSpeed4-slow4*2+slow41*2 < py+ps){
                                if(ebx4+bs > px && ebx4 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右
                            context.fillRect(ebx4+slow41,eby4+eSpeed4-slow4*2+slow41*1,bs,bs)

                            if(eby4+bs+eSpeed4-slow4*2+slow41*1 > py && eby4+eSpeed4-slow4*2+slow41*1 < py+ps){
                                if(ebx4+bs+slow41 > px && ebx4+slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左
                            context.fillRect(ebx4-slow41,eby4+eSpeed4-slow4*2+slow41*1,bs,bs)

                            if(eby4+bs+eSpeed4-slow4*2+slow41*1 > py && eby4+eSpeed4-slow4*2+slow41*1 < py+ps){
                                if(ebx4+bs-slow41 > px && ebx4-slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右下
                            context.fillRect(ebx4+slow41/2,eby4+eSpeed4-slow4*2+slow41*3/2,bs,bs)

                            if(eby4+bs+eSpeed4-slow4*2+slow41*3/2 > py && eby4+eSpeed4-slow4*2+slow41*3/2 < py+ps){
                                if(ebx4+bs+slow41/2 > px && ebx4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左下
                            context.fillRect(ebx4-slow41/2,eby4+eSpeed4-slow4*2+slow41*3/2,bs,bs)

                            if(eby4+bs+eSpeed4-slow4*2+slow41*3/2 > py && eby4+eSpeed4-slow4*2+slow41*3/2 < py+ps){
                                if(ebx4+bs-slow41/2 > px && ebx4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右上
                            context.fillRect(ebx4+slow41/2,eby4+eSpeed4-slow4*2+slow41/2,bs,bs)

                            if(eby4+bs+eSpeed4-slow4*2+slow41/2 > py && eby4+eSpeed4-slow4*2+slow41/2 < py+ps){
                                if(ebx4+bs+slow41/2 > px && ebx4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左上
                            context.fillRect(ebx4-slow41/2,eby4+eSpeed4-slow4*2+slow41/2,bs,bs)

                            if(eby4+bs+eSpeed4-slow4*2+slow41/2 > py && eby4+eSpeed4-slow4*2+slow41/2 < py+ps){
                                if(ebx4+bs-slow41/2 > px && ebx4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                    //下----------
                        context.fillStyle = "cyan"
                        //下あんのかよ
                        context.fillRect(ebx4,eby4+eSpeed4+slow41*2,bs,bs)

                        if(eby4+bs+eSpeed4+slow41*2 > py && eby4+eSpeed4+slow41*2 < py+ps){
                                if(ebx4+bs > px && ebx4 < px+ps){
                                    pHP-=1
                                }
                            }
                        //上
                        context.fillRect(ebx4,eby4+eSpeed4-slow41*2+slow41*2,bs,bs)//下

                        if(eby4+bs+eSpeed4-slow41*2+slow41*2 > py && eby4+eSpeed4-slow41*2+slow41*2 < py+ps){
                                if(ebx4+bs > px && ebx4 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右???
                        context.fillRect(ebx4+slow41,eby4+eSpeed4-slow41*1+slow41*2,bs,bs)//下

                        if(eby4+bs+eSpeed4-slow41*1+slow41*2 > py && eby4+eSpeed4-slow41*1+slow41*2 < py+ps){
                                if(ebx4+bs+slow41 > px && ebx4+slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左???
                        context.fillRect(ebx4-slow41,eby4+eSpeed4-slow41*1+slow41*2,bs,bs)//下

                        if(eby4+bs+eSpeed4-slow41*1+slow41*2 > py && eby4+eSpeed4-slow41*1+slow41*2 < py+ps){
                                if(ebx4+bs-slow41 > px && ebx4-slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右下
                        context.fillRect(ebx4+slow41/2,eby4+eSpeed4-slow41*3/2+slow41*2,bs,bs)//下

                        if(eby4+bs+eSpeed4-slow41*3/2+slow41*2 > py && eby4+eSpeed4-slow41*3/2+slow41*2 < py+ps){
                                if(ebx4+bs+slow41/2 > px && ebx4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左下
                        context.fillRect(ebx4-slow41/2,eby4+eSpeed4-slow41*3/2+slow41*2,bs,bs)//下

                        if(eby4+bs+eSpeed4-slow41*3/2+slow41*2 > py && eby4+eSpeed4-slow41*3/2+slow41*2 < py+ps){
                                if(ebx4+bs-slow41/2 > px && ebx4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右上
                        context.fillRect(ebx4+slow41/2,eby4+eSpeed4-slow41/2+slow41*2,bs,bs)//下

                        if(eby4+bs+eSpeed4-slow41/2+slow41*2 > py && eby4+eSpeed4-slow41/2+slow41*2 < py+ps){
                                if(ebx4+bs+slow41/2 > px && ebx4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左上
                        context.fillRect(ebx4-slow41/2,eby4+eSpeed4-slow41/2+slow41*2,bs,bs)//下

                        if(eby4+bs+eSpeed4-slow41/2+slow41*2 > py && eby4+eSpeed4-slow41/2+slow41*2 < py+ps){
                                if(ebx4+bs-slow41/2 > px && ebx4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }

                    //右----------
                        context.fillStyle = "violet"
                        //右あるのかよ
                        context.fillRect(ebx4+slow4+slow41,eby4+eSpeed4-slow4+slow41*1,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*1 > py && eby4+eSpeed4-slow4+slow41*1 < py+ps){
                                if(ebx4+bs+slow4+slow41 > px && ebx4+slow4+slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //下
                        context.fillRect(ebx4+slow4,eby4+eSpeed4-slow4+slow41*2,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*2 > py && eby4+eSpeed4-slow4+slow41*2 < py+ps){
                                if(ebx4+bs+slow4 > px && ebx4+slow4 < px+ps){
                                    pHP-=1
                                }
                            }
                        //上
                        context.fillRect(ebx4+slow4,eby4+eSpeed4-slow4+slow41,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41 > py && eby4+eSpeed4-slow4+slow41 < py+ps){
                                if(ebx4+bs+slow4 > px && ebx4+slow4 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左
                        context.fillRect(ebx4+slow4-slow41,eby4+eSpeed4-slow4+slow41*1,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*1 > py && eby4+eSpeed4-slow4+slow41*1 < py+ps){
                                if(ebx4+bs+slow4-slow41 > px && ebx4+slow4-slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右下
                        context.fillRect(ebx4+slow4+slow41/2,eby4+eSpeed4-slow4+slow41*3/2,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*3/2 > py && eby4+eSpeed4-slow4+slow41*3/2 < py+ps){
                                if(ebx4+bs+slow4+slow41/2 > px && ebx4+slow4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左下
                        context.fillRect(ebx4+slow4-slow41/2,eby4+eSpeed4-slow4+slow41*3/2,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*3/2 > py && eby4+eSpeed4-slow4+slow41*3/2 < py+ps){
                                if(ebx4+bs+slow4-slow41/2 > px && ebx4+slow4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右上
                        context.fillRect(ebx4+slow4+slow41/2,eby4+eSpeed4-slow4+slow41/2,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41/2 > py && eby4+eSpeed4-slow4+slow41/2 < py+ps){
                                if(ebx4+bs+slow4+slow41/2 > px && ebx4+slow4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左上
                        context.fillRect(ebx4+slow4-slow41/2,eby4+eSpeed4-slow4+slow41/2,bs,bs)//右 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41/2 > py && eby4+eSpeed4-slow4+slow41/2 < py+ps){
                                if(ebx4+bs+slow4-slow41/2 > px && ebx4+slow4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                    //左----------
                        context.fillStyle = "#00ced1"
                        //左なし
                        context.fillRect(ebx4-slow4-slow41,eby4+eSpeed4-slow4+slow41*1,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*1 > py && eby4+eSpeed4-slow4+slow41*1 < py+ps){
                                if(ebx4+bs-slow4-slow41 > px && ebx4-slow4-slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //下
                        context.fillRect(ebx4-slow4,eby4+eSpeed4-slow4+slow41*2,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*2 > py && eby4+eSpeed4-slow4+slow41*2 < py+ps){
                                if(ebx4+bs-slow4 > px && ebx4-slow4 < px+ps){
                                    pHP-=1
                                }
                            }
                        //上
                        context.fillRect(ebx4-slow4,eby4+eSpeed4-slow4+slow41,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41 > py && eby4+eSpeed4-slow4+slow41 < py+ps){
                                if(ebx4+bs-slow4 > px && ebx4-slow4 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右
                        context.fillRect(ebx4-slow4+slow41,eby4+eSpeed4-slow4+slow41*1,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*1 > py && eby4+eSpeed4-slow4+slow41*1 < py+ps){
                                if(ebx4+bs-slow4+slow41 > px && ebx4-slow4+slow41 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右下
                        context.fillRect(ebx4-slow4+slow41/2,eby4+eSpeed4-slow4+slow41*3/2,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*3/2 > py && eby4+eSpeed4-slow4+slow41*3/2 < py+ps){
                                if(ebx4+bs-slow4+slow41/2 > px && ebx4-slow4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左下
                        context.fillRect(ebx4-slow4-slow41/2,eby4+eSpeed4-slow4+slow41*3/2,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41*3/2 > py && eby4+eSpeed4-slow4+slow41*3/2 < py+ps){
                                if(ebx4+bs-slow4-slow41/2 > px && ebx4-slow4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //右上
                        context.fillRect(ebx4-slow4+slow41/2,eby4+eSpeed4-slow4+slow41/2,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41/2 > py && eby4+eSpeed4-slow4+slow41/2 < py+ps){
                                if(ebx4+bs-slow4+slow41/2 > px && ebx4-slow4+slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }
                        //左上
                        context.fillRect(ebx4-slow4-slow41/2,eby4+eSpeed4-slow4+slow41/2,bs,bs)//左 eSpeed4-slow = 0 y は停止する

                        if(eby4+bs+eSpeed4-slow4+slow41/2 > py && eby4+eSpeed4-slow4+slow41/2 < py+ps){
                                if(ebx4+bs-slow4-slow41/2 > px && ebx4-slow4-slow41/2 < px+ps){
                                    pHP-=1
                                }
                            }

                }
            }else{
                r401 -= 0.016
            }
            requestAnimationFrame(bulletAnimation4)
        }else{
            finished4 = true
            count4 = 1
        }
    }
    bulletAnimation4()
}

function eShot4b(){
    r41 = Math.random()
    eSpeed4b = 0
    eby4b = ey4
    ebx4b = ex4
    slow4b = 0
    LockCoin = false
    function bulletAnimation4b(){
        //スコアコイン
        if(LockCoin == false){
            context.fillStyle = "gold"
            context.fillRect(ebx4b,eby4b+eSpeed4b/2,bs*2,bs*2)
            context.fillStyle = "white"
            context.font = ts*2+"px bold serif"//文字サイズの変数指定
            context.fillText("￥",ebx4b,eby4b+eSpeed4b/2+bs*1.8)
            if(eby4b+eSpeed4b/2+bs*2 > py && eby4b+eSpeed4b/2 < py+ps){//コインの当たり判定
                if(ebx4b+bs*2 > px && ebx4b < px+ps){
                    score+=60
                    LockCoin = true
                }
            }
        }

        if(eHP4 > 0 && eby4b+eSpeed4b < ch){
            eSpeed4b+=cw*0.004
            if(count4 == 1){
                context.fillStyle = "orange"
            }else if(count4 == 2){
                context.fillStyle = "lime"
            }else if(count4 == 3){
                context.fillStyle = "aqua"
            }else{
                context.fillStyle = "yellow"
            }
            context.fillRect(ebx4b,eby4b+eSpeed4b,bs,bs)//弾幕1下

            if(eby4b+eSpeed4b+bs > py && eby4b+eSpeed4b < py+ps){
                if(ebx4b+bs > px && ebx4b < px+ps){
                    pHP-=1
                }
            }



            if(r41*ch*0.5 < eby4b+eSpeed4b){
                slow4b += cw*0.004//弾幕1と反対向きに移動するので *2 したらちょうど同じ速度
                context.fillRect(ebx4b,eby4b+eSpeed4b-slow4b,bs,bs)//上

                if(eby4b+eSpeed4b-slow4b+bs > py && eby4b+eSpeed4b-slow4b < py+ps){
                    if(ebx4b+bs > px && ebx4b < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b-slow4b/2,eby4b+eSpeed4b-slow4b/2,bs,bs)//左 slow4b/2 = eSpeed4b なので y は止まる

                if(eby4b+eSpeed4b-slow4b/2+bs > py && eby4b+eSpeed4b-slow4b/2 < py+ps){
                    if(ebx4b-slow4b/2+bs > px && ebx4b-slow4b/2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b-slow4b/4,eby4b+eSpeed4b-slow4b/4*3,bs,bs)//左上 eSpeed4b = slow4b /2 eSpeed4b-slow4b = -slow4b /2 にしたいので /4*3 計算したらなる

                if(eby4b+eSpeed4b-slow4b/4*3+bs > py && eby4b+eSpeed4b-slow4b/4*3 < py+ps){
                    if(ebx4b-slow4b/4+bs > px && ebx4b-slow4b/4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b-slow4b/4,eby4b+eSpeed4b-slow4b/4,bs,bs)//左下 弾の瞬間移動を避けるために原点になる eSpeed4b はいじられない

                if(eby4b+eSpeed4b-slow4b/4+bs > py && eby4b+eSpeed4b-slow4b/4 < py+ps){
                    if(ebx4b-slow4b/4+bs > px && ebx4b-slow4b/4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b+slow4b/2,eby4b+eSpeed4b-slow4b/2,bs,bs)//右 slow4b/2 = eSpeed4b なので y は止まる

                if(eby4b+eSpeed4b-slow4b/2+bs > py && eby4b+eSpeed4b-slow4b/2 < py+ps){
                    if(ebx4b+slow4b/2+bs > px && ebx4b+slow4b/2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b+slow4b/4,eby4b+eSpeed4b-slow4b/4*3,bs,bs)//右上

                if(eby4b+eSpeed4b-slow4b/4*3+bs > py && eby4b+eSpeed4b-slow4b/4*3 < py+ps){
                    if(ebx4b+slow4b/4+bs > px && ebx4b+slow4b/4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b+slow4b/4,eby4b+eSpeed4b-slow4b/4,bs,bs)//右下

                if(eby4b+eSpeed4b-slow4b/4+bs > py && eby4b+eSpeed4b-slow4b/4 < py+ps){
                    if(ebx4b+slow4b/4+bs > px && ebx4b+slow4b/4 < px+ps){
                        pHP-=1
                    }
                }

            }

            finished4b = false//eShot4b()を実行してる間は他の弾幕生成関数を呼び出さない
            requestAnimationFrame(bulletAnimation4b)
        }else{
            finished4b = true
            if(count4 > 4){
                count4 = 0
            }else{
                count4 += 1
            }

        }
    }
    bulletAnimation4b()
}

function eShot4b2(){
    r41b = Math.random()
    eSpeed4b2 = 0
    eby4b2 = ey4
    ebx4b2 = ex4
    slow4b2 = 0
    function bulletAnimation4b2(){
        if(eHP4 > 0 && eby4b2+eSpeed4b2 < ch){
            eSpeed4b2+=cw*0.004
            if(count4b == 1){
                context.fillStyle = "orange"
            }else if(count4b == 2){
                context.fillStyle = "lime"
            }else if(count4b == 3){
                context.fillStyle = "aqua"
            }else{
                context.fillStyle = "yellow"
            }
            context.fillRect(ebx4b2,eby4b2+eSpeed4b2,bs,bs)//弾幕1下

            if(eby4b2+eSpeed4b2+bs > py && eby4b2+eSpeed4b2 < py+ps){
                if(ebx4b2+bs > px && ebx4b2 < px+ps){
                    pHP-=1
                }
            }

            if(r41b*ch*0.5 < eby4b2+eSpeed4b2){
                slow4b2 += cw*0.004//弾幕1と反対向きに移動するので *2 したらちょうど同じ速度
                context.fillRect(ebx4b2,eby4b2+eSpeed4b2-slow4b2,bs,bs)//上

                if(eby4b2+eSpeed4b2-slow4b2+bs > py && eby4b2+eSpeed4b2-slow4b2 < py+ps){
                    if(ebx4b2+bs > px && ebx4b2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b2-slow4b2/2,eby4b2+eSpeed4b2-slow4b2/2,bs,bs)//左 slow4b2/2 = eSpeed4b2 なので y は止まる

                if(eby4b2+eSpeed4b2-slow4b2/2+bs > py && eby4b2+eSpeed4b2-slow4b2/2 < py+ps){
                    if(ebx4b2-slow4b2/2+bs > px && ebx4b2-slow4b2/2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b2-slow4b2/4,eby4b2+eSpeed4b2-slow4b2/4*3,bs,bs)//左上 eSpeed4b2 = slow4b2 /2 eSpeed4b2-slow4b2 = -slow4b2 /2 にしたいので /4*3 計算したらなる

                if(eby4b2+eSpeed4b2-slow4b2/4*3+bs > py && eby4b2+eSpeed4b2-slow4b2/4*3 < py+ps){
                    if(ebx4b2-slow4b2/4+bs > px && ebx4b2-slow4b2/4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b2-slow4b2/4,eby4b2+eSpeed4b2-slow4b2/4,bs,bs)//左下 弾の瞬間移動を避けるために原点になる eSpeed4b2 はいじられない

                if(eby4b2+eSpeed4b2-slow4b2/4+bs > py && eby4b2+eSpeed4b2-slow4b2/4 < py+ps){
                    if(ebx4b2-slow4b2/4+bs > px && ebx4b2-slow4b2/4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b2+slow4b2/2,eby4b2+eSpeed4b2-slow4b2/2,bs,bs)//右 slow4b2/2 = eSpeed4b2 なので y は止まる

                if(eby4b2+eSpeed4b2-slow4b2/2+bs > py && eby4b2+eSpeed4b2-slow4b2/2 < py+ps){
                    if(ebx4b2+slow4b2/2+bs > px && ebx4b2+slow4b2/2 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b2+slow4b2/4,eby4b2+eSpeed4b2-slow4b2/4*3,bs,bs)//右上

                if(eby4b2+eSpeed4b2-slow4b2/4*3+bs > py && eby4b2+eSpeed4b2-slow4b2/4*3 < py+ps){
                    if(ebx4b2+slow4b2/4+bs > px && ebx4b2+slow4b2/4 < px+ps){
                        pHP-=1
                    }
                }

                context.fillRect(ebx4b2+slow4b2/4,eby4b2+eSpeed4b2-slow4b2/4,bs,bs)//右下

                if(eby4b2+eSpeed4b2-slow4b2/4+bs > py && eby4b2+eSpeed4b2-slow4b2/4 < py+ps){
                    if(ebx4b2+slow4b2/4+bs > px && ebx4b2+slow4b2/4 < px+ps){
                        pHP-=1
                    }
                }

            }

            finished4b2 = false//eShot4b()を実行してる間は他の弾幕生成関数を呼び出さない
            requestAnimationFrame(bulletAnimation4b2)
        }else{
            finished4b2 = true
            if(count4b > 4){
                count4b = 0
            }else{
                count4b += 1
            }

        }
    }
    bulletAnimation4b2()
}

function roop2(){
    context.fillStyle = "skyblue"//プレーヤーの色
    context.fillRect(px,py,ps,ps)//プレーヤーの描画

    //CPU0------------------------------------------------------------------------------------------------
    if(Lock == false){//CPU0が生きていたら

        //HPバー-----------------------------------------
        context.fillStyle = "lime"
        context.globalAlpha = 0.5//透明度
        //HPバー背景
        context.fillRect(ex,ey-cw*0.01*2,50*cw*0.001,cw*0.01)
        context.globalAlpha = 1
        context.fillRect(ex,ey-cw*0.01*2,eHP*cw*0.001,cw*0.01)
        context.fillStyle = "orange"

        if(LR == "left"){
            if(ex > 0){
                ex = ex - cw*0.002//画面端にCPU0が到達してなかったらCPU0を左に進ませる
            }else{
                LR = "right"
            }
        }else{//右に進ませる処理↓
            ex = ex + 2//CPU0を右に進ませる
            if(ex+ps >= cw){//プレーヤーサイズが画面横サイズ以上だったら　→　画面の端にCPU0がぶつかったら方向を変える
                LR = "left"
            }else{
                ex = ex + cw*0.002//画面端にCPU0が到達してなかったらCPU0を右に進ませる
            }
        }
        context.fillRect(ex,ey,es,es)//CPU0の描画
    }


    //CPU0↑CPU2↓
    if(Lock2 == false){//kill数が 1 以上なら CPU2が生きてたら
        //HPバー-----------------------------------------
        context.fillStyle = "lime"
        context.globalAlpha = 0.5//透明度
        //HPバー背景
        context.fillRect(ex2,ey2-cw*0.01*2,75*cw*0.001,cw*0.01)
        context.globalAlpha = 1
        context.fillRect(ex2,ey2-cw*0.01*2,eHP2*cw*0.001,cw*0.01)
        if(LR2 == "left"){
            if(ex2 > 0){
                if(K == false){
                    ex2 = ex2 - cw*0.005//プレーヤーが高速移動してなかったら被弾を避けるためにCPU2を速く動かす
                }else{
                    ex2 = ex2 - cw*0.003//画面端にCPU2が到達してなかったらCPU2を左に進ませる
                }
            }else{
                LR2 = "right"
            }
        }else{//右に進ませる処理↓
            ex2 = ex2 + 2//CPU2を右に進ませる
            if(ex2+ps >= cw){//プレーヤーサイズが画面横サイズ以上だったら　→　画面の端にCPU2がぶつかったら方向を変える
                LR2 = "left"
            }else{
                if(K == false){
                    ex2 = ex2 + cw*0.005//プレーヤーが高速移動してなかったら被弾を避けるためにCPU2を速く動かす
                }
                ex2 = ex2 + cw*0.003//画面端にCPU2が到達してなかったらCPU2を右に進ませる
            }
        }

        context.fillStyle = "red"
        context.fillRect(ex2,ey2,es2,es2)
    }

    //CPU3,3b,4↓
    if(Lock3 == false){//kill数が2以上4以下
        //HPバー-----------------------------------------
        context.fillStyle = "lime"
        context.globalAlpha = 0.5//透明度
        //HPバー背景
        context.fillRect(ex3,ey3-cw*0.01*2,40*cw*0.001,cw*0.01)
        context.globalAlpha = 1
        context.fillRect(ex3,ey3-cw*0.01*2,eHP3*cw*0.001,cw*0.01)

        if(LR3 == "left"){
            if(ex3 > 0){
                ex3 -= cw*0.002
            }else{
                LR3 = "right"
            }
        }else{//右に進ませる処理↓
            if(ex3+es3 >= ex3b){//CPU3 が CPU3bにぶつかったら 進行方向を変える CPU3は右に進む時しか CPU3b とぶつからない
                LR3 = "left"
            }else{
                ex3 += cw*0.002
            }
        }

        context.fillStyle = "deepskyblue"
        context.fillRect(ex3,ey3,es3,es3)
    }
    if(Lock3b == false){
        //HPバー-----------------------------------------
        context.fillStyle = "lime"
        context.globalAlpha = 0.5//透明度
        //HPバー背景
        context.fillRect(ex3b,ey3-cw*0.01*2,40*cw*0.001,cw*0.01)
        context.globalAlpha = 1
        context.fillRect(ex3b,ey3-cw*0.01*2,eHP3b*cw*0.001,cw*0.01)
        if(LR3b == "left"){
            if(ex3b <= ex3+es3){//CPU3b が CPU3にぶつかったら 進行方向を変える CPU3bは左に進む時しか CPU3 とぶつからない
                LR3b = "rihgt"
            }else{
                ex3b -= cw*0.002
            }
        }else{//右に進ませる処理↓
            if(ex3b+es3b < cw){
                ex3b += cw*0.002
            }else{
                LR3b = "left"
            }
        }
        context.fillStyle = "deepskyblue"
        context.fillRect(ex3b,ey3,es3b,es3b)
    }
//CPU2↑-----------------------------------------------------------------------------------------------


    //CPU4↓
    if(Lock4 == false){//CPU3,3bが死んだら実行可能
        //HPバー-----------------------------------------
        context.fillStyle = "lime"
        context.globalAlpha = 0.5//透明度
        //HPバー背景
        context.fillRect(ex4,ey4-cw*0.01*2,100*cw*0.001,cw*0.01)
        context.globalAlpha = 1
        context.fillRect(ex4,ey4-cw*0.01*2,eHP4*cw*0.001,cw*0.01)
        if(LR4 == "left"){
            if(ex4 > 0){
                if(K == false){
                    ex4 = ex4 - cw*0.005//プレーヤーが高速移動してなかったら被弾を避けるためにCPU4を速く動かす
                }else{
                    ex4 = ex4 - cw*0.003//画面端にCPU4が到達してなかったらCPU4を左に進ませる
                }
            }else{
                LR4 = "right"
            }
        }else{//右に進ませる処理↓
            if(ex4+es4 > cw){
                LR4 = "left"
            }else{
                if(K == false){
                    ex4 = ex4 + cw*0.005//プレーヤーが高速移動してなかったら被弾を避けるためにCPU4を速く動かす
                }
                ex4 = ex4 + cw*0.003//画面端にCPU4が到達してなかったらCPU4を右に進ませる
            }
        }
        context.fillRect(ex4,ey4,es4,es4)//CPU4の描画

    }


    //間接的にwasdが押されたことを判定する
    if(W == true){
        //wが押されたら プレーヤー の y 座用を - する
        //画面上方向は -
        py = py - speed01
    }
    if(A == true){
        //aが押されたら プレーヤー の x 座用を - する
        px = px - speed01
    }
    if(S == true){
        //sが押されたら プレーヤー の y 座用を + する
        //画面下方向は +
        py = py + speed01
    }
    if(D == true){
        //dが押されたら プレーヤー の x 座用を + する
        px = px + speed01
    }

    //UI文字↓
    context.fillStyle = "white"//文字図形色
    context.font = ts+"px bold serif"//文字サイズの変数指定
    context.fillText("スコア:"+score,tx,ty)//スコアの描画
    context.fillText(tMin+"分:"+tSec+"秒",tx+tSpace,ty)//時間の描画
    context.fillText("HP:"+pHP,tx2,ty)

    if(pHP >= 0){//プレーヤーが生きている限り処理を続ける
        requestAnimationFrame(roop2)//説明は 99 行参照
    }else{
        if(fix == 0){//ゲーム終了の通知が初めてなら
            scoreOutput()//スコアを計算して出力する関数
            fix=1//二度呼び出されるのを防ぐ
        }
    }

    //HPバー
    if(pHP > 25){
        context.fillStyle = "lime"//pHPが半分以上なら緑
    }else if(pHP > 10){
        context.fillStyle = "orange"//pHP11以上25未満はオレンジ
    }else{
        context.fillStyle = "red"//pHP10以下は赤
    }

    context.globalAlpha = "0.1"//HPバーの背景 透明度を指定してる
    context.fillRect(tx2,ty,50*cw*0.0018,cw*0.01)//cw ※canvas wide を掛けるのは どんな画面サイズにも相対的な大きさで描画するため
    context.globalAlpha = "1"//HPバー本体の描画 不透明
    context.fillRect(tx2,ty,pHP*cw*0.0018,cw*0.01)//pHP を掛けることで pHP の変化に応じてバーの x サイズが変わる
}//roop2()終了



function scoreOutput() {
    //スコアをテキストファイルの名前に出力する
    if(eHP4 <= 0){
        score = score+pHP+200-tSec2//クリアしたら残りHPとクリア時間を配慮してスコアを計算する
    }else{
        context.font = ts*5+"px bold serif"//文字サイズの変数指定
        context.fillStyle = "white"
        context.fillText("GameOver :(",ts,ch*0.5-ts)

    }
    let blob = new Blob(['疲れたla..'+score],{type:"text/plan"});//ファイルの作成
    let link = document.createElement('a');//HTMLaタグの作成
    link.href = URL.createObjectURL(blob);
    link.download = '名無しスコア:'+score+'.txt';
    link.click();
    alert("GameOver")
}
<!--
Thanks for playing and seeing!!:D
遊んでくれてありがとう！
コード見てくれてありがとう！
      -9090909090-
    90=-        -90=
  90=   =909090-   90=
90=   *90     *9=   -90
-90-   =90     -00-   90-
-90    =90     -90=   90=
=90    *90-    -00=   90=
=89     *=90909090=   90=
-90-           =90-   90-
-99=          90*    -90
 *90=  *=9090*    =90=
    909-        -90=
   　 -9090909909-      2021 ⑨な人Project.
-->`

var txt1 = txt0.split(``)
var n = [0]
var space = [0]
var body = document.getElementById("body")
//body.style.color = "lime"
body.style.backgroundColor = "black"
while(n.length < 1717){
    n.push(txt1.indexOf(`\n`,n[n.length-1]+1))
    txt1.splice(n[n.length-1],1,`<br>`)
}
while(space.length < 34145){
    space.push(txt1.indexOf(` `,space[space.length-1]+1))
    txt1.splice(space[space.length-1],1,`&nbsp;`)
}

console.log(n)
console.log(txt1)
var r = 255
var r2 = 255
var g = 0
var b = 0
var red=false
var redMinus = true
var green = true
var greenMinus = false
var blue = false
var blueMinus = false

var count = 0
var top = 0
var fonts = 10
var stop = false
var cRate = 0.3
var spNum = 0
function animation(){
    if(count < txt1.length){

        while(spNum < speed){
            body.insertAdjacentHTML('beforeend',txt1[count])
            window.scrollTo(0,200000)
            spNum++
            count++
        }
        spNum = 0
    }else{
        count=0
	body.innerHTML = ("")
    }
    if(stop == false){
if(red){
		if(r2<255){
			r2+=cRate
		}else{
			red=false
			greenMinus=false
			blueMinus=true
			green=true
		}
	}
	if(redMinus){
		if(r2>0){
			r2-=cRate
		}

	}
	if(green){
		if(g<255){//r=255,gは0から255まで上昇中
			g+=cRate
		}else{//r=255から減少,g=255のまま
			green=false
			redMinus = true
			blueMinus = false
			blue=true
		}
	}
	if(greenMinus){
		if(g>0){
			g-=cRate
		}

	}
	if(blue){
		if(b<255){//
			b+=cRate
		}else{
			blue=false
			greenMinus = true
			redMinus = false
			red=true
		}
	}
	if(blueMinus){
		if(b>0){
			b-=cRate
		}

	}
	//ctx.fillStyle = `rgb(${r},${g},${b})`
	body.style.color = `rgb(${r2},${g},${b})`
        requestAnimationFrame(animation)
    }
}animation()
document.addEventListener("keydown",function(event){
    if(event.key == " "){
        if(stop == false){
            stop = true
        }else{
            stop = false
            animation()
        }
    }
})
</script>
